# Firewall Log Analysis

Firewalls, whether physical or virtual devices, play a crucial role in controlling incoming and outgoing network packets based on predefined rules aligned with the organization's cybersecurity policies. These devices are deployed on individual systems/servers or centrally managed in large organizations through public-facing firewall devices. Network communication primarily traverses through the firewall, reaching its destination based on the established rules.

Given their significance, firewalls stand as one of the most important security components, regulating network access within organizations. Hence, it is imperative for SOC Analysts to proficiently analyze the logs generated by firewall devices.

In the contemporary landscape, modern firewall devices go beyond mere packet routing (OSI Layer-3) based on predefined rules; they incorporate additional modules to perform diverse tasks. For instance, they can identify applications and their content at the application layer (OSI Layer-7). Firewalls equipped with such capabilities are termed Next-Generation Firewalls (NGFW). The logs from these firewalls may mention application names like 'app' and 'services,' indicating NGFW capabilities. Recognizing specific applications allows the formulation of application-based rules, enabling more granular control compared to traditional port-based rules.

The essential logs generated by firewalls pertain to the traffic passing through the device. These logs typically provide information such as traffic time, source IP/Port, destination IP/Port, interface details, and more.

## Sample Firewall Traffic Log

plaintexts
date=2022-05-21 time=14:06:38 devname="FG500" devid="FG5HSTF109K" eventtime=1653131198230012501 tz="+0300" logid="0000000013" type="traffic" subtype="forward" level="notice" vd="root" srcip=172.14.14.26 srcname="CNL" srcport=50495 srcintf="ACC-LAN" srcintfrole="lan" dstip=142.250.186.142 dstport=443 dstintf="Wan" dstintfrole="wan" srccountry="Reserved" dstcountry="United States" sessionid=445180938 proto=6 action="accept" policyid=284 policytype="policy" poluuid="8ec32778-a70a-51ec-9265-8fdf896d07f1" service="HTTPS" trandisp="snat" transip=89.145.185.195 transport=50495 duration=72 sentbyte=2518 rcvdbyte=49503 sentpkt=13 rcvdpkt=42
